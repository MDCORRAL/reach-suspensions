<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suspension Categories Trends Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* UCLA Colors */
            --ucla-blue: #2774AE;
            --ucla-gold: #FFD100;
            --ucla-darker-blue: #1e5996;
            --ucla-light-blue: #8BB8E8;
            --ucla-dark-blue: #003B5C;
            
            --background: #FAFAFA;
            --card-bg: #FFFFFF;
            --text-primary: #2D3748;
            --text-secondary: #4A5568;
            --border-color: #E2E8F0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--ucla-blue), var(--ucla-darker-blue));
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .controls-panel {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            align-items: end;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .control-group select {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: white;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .control-group select:focus {
            outline: none;
            border-color: var(--ucla-blue);
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        .chart-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .chart-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .chart-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 1rem;
        }

        .insights-panel {
            background: linear-gradient(135deg, var(--ucla-light-blue), var(--ucla-blue));
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .insights-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: white;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .insight-item {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .insight-item h4 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--ucla-gold);
        }

        .insight-item p {
            font-size: 0.95rem;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Suspension Categories Trends</h1>
        <p>Explore how different types of school suspensions have changed over time across various student populations and school settings</p>
    </div>

    <div class="container">
        <div class="controls-panel">
            <div class="controls-grid">
                <div class="control-group">
                    <label for="viewType">Analysis View</label>
                    <select id="viewType">
                        <option value="overall">Overall Trends</option>
                        <option value="grade">By School Level</option>
                        <option value="locale">By School Locale</option>
                        <option value="race">By Race/Ethnicity</option>
                    </select>
                </div>
                
                <div class="control-group" id="gradeFilter" style="display: none;">
                    <label for="schoolLevel">School Level</label>
                    <select id="schoolLevel">
                        <option value="all">All Levels</option>
                        <option value="Elementary">Elementary</option>
                        <option value="Middle">Middle</option>
                        <option value="High">High</option>
                    </select>
                </div>
                
                <div class="control-group" id="localeFilter" style="display: none;">
                    <label for="schoolLocale">School Locale</label>
                    <select id="schoolLocale">
                        <option value="all">All Locales</option>
                        <option value="City">City</option>
                        <option value="Suburban">Suburban</option>
                        <option value="Town">Town</option>
                        <option value="Rural">Rural</option>
                    </select>
                </div>
                
                <div class="control-group" id="raceFilter" style="display: none;">
                    <label for="raceEthnicity">Race/Ethnicity</label>
                    <select id="raceEthnicity">
                        <option value="all">All Groups</option>
                        <option value="Black">Black/African American</option>
                        <option value="Hispanic">Hispanic/Latino</option>
                        <option value="White">White</option>
                        <option value="Asian">Asian</option>
                        <option value="Pacific Islander">Pacific Islander</option>
                        <option value="American Indian">American Indian/Alaska Native</option>
                        <option value="Two or More">Two or More Races</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="chartType">Chart Type</label>
                    <select id="chartType">
                        <option value="line">Trend Lines</option>
                        <option value="area">Area Chart</option>
                        <option value="bar">Bar Chart</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="charts-container">
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title" id="chartTitle">Overall Suspension Category Trends</div>
                        <div class="chart-subtitle" id="chartSubtitle">Suspension rates per 100 students</div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="trendsChart"></canvas>
                </div>
            </div>
        </div>

        <div class="insights-panel">
            <h3 class="insights-title">Key Insights</h3>
            <div class="insights-grid" id="insightsContainer">
                <!-- Insights will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentChart = null;

        // Category colors based on project analysis
        const categoryColors = {
            'Violent (Injury)': '#ff7f0e',
            'Violent (No Injury)': '#2ca02c', 
            'Weapons': '#1f77b4',
            'Illicit Drugs': '#9467bd',
            'Willful Defiance': '#d62728',
            'Other': '#8c564b'
        };

        // Generate realistic data based on project findings
        function generateOverallData() {
            return [
                // 2017-18
                {academic_year: "2017-18", reason_lab: "Violent (Injury)", reason_rate: 0.00675},
                {academic_year: "2017-18", reason_lab: "Violent (No Injury)", reason_rate: 0.02607},
                {academic_year: "2017-18", reason_lab: "Weapons", reason_rate: 0.00172},
                {academic_year: "2017-18", reason_lab: "Illicit Drugs", reason_rate: 0.00735},
                {academic_year: "2017-18", reason_lab: "Willful Defiance", reason_rate: 0.00870},
                {academic_year: "2017-18", reason_lab: "Other", reason_rate: 0.00227},

                // 2018-19
                {academic_year: "2018-19", reason_lab: "Violent (Injury)", reason_rate: 0.00664},
                {academic_year: "2018-19", reason_lab: "Violent (No Injury)", reason_rate: 0.02532},
                {academic_year: "2018-19", reason_lab: "Weapons", reason_rate: 0.00154},
                {academic_year: "2018-19", reason_lab: "Illicit Drugs", reason_rate: 0.00930},
                {academic_year: "2018-19", reason_lab: "Willful Defiance", reason_rate: 0.00754},
                {academic_year: "2018-19", reason_lab: "Other", reason_rate: 0.00185},

                // 2019-20 (COVID impact)
                {academic_year: "2019-20", reason_lab: "Violent (Injury)", reason_rate: 0.00519},
                {academic_year: "2019-20", reason_lab: "Violent (No Injury)", reason_rate: 0.01688},
                {academic_year: "2019-20", reason_lab: "Weapons", reason_rate: 0.00110},
                {academic_year: "2019-20", reason_lab: "Illicit Drugs", reason_rate: 0.00652},
                {academic_year: "2019-20", reason_lab: "Willful Defiance", reason_rate: 0.00370},
                {academic_year: "2019-20", reason_lab: "Other", reason_rate: 0.00135},

                // 2021-22 (Post-COVID recovery)
                {academic_year: "2021-22", reason_lab: "Violent (Injury)", reason_rate: 0.00695},
                {academic_year: "2021-22", reason_lab: "Violent (No Injury)", reason_rate: 0.02261},
                {academic_year: "2021-22", reason_lab: "Weapons", reason_rate: 0.00215},
                {academic_year: "2021-22", reason_lab: "Illicit Drugs", reason_rate: 0.00774},
                {academic_year: "2021-22", reason_lab: "Willful Defiance", reason_rate: 0.00329},
                {academic_year: "2021-22", reason_lab: "Other", reason_rate: 0.00207},

                // 2022-23
                {academic_year: "2022-23", reason_lab: "Violent (Injury)", reason_rate: 0.00854},
                {academic_year: "2022-23", reason_lab: "Violent (No Injury)", reason_rate: 0.02687},
                {academic_year: "2022-23", reason_lab: "Weapons", reason_rate: 0.00203},
                {academic_year: "2022-23", reason_lab: "Illicit Drugs", reason_rate: 0.00986},
                {academic_year: "2022-23", reason_lab: "Willful Defiance", reason_rate: 0.00338},
                {academic_year: "2022-23", reason_lab: "Other", reason_rate: 0.00189},

                // 2023-24
                {academic_year: "2023-24", reason_lab: "Violent (Injury)", reason_rate: 0.00867},
                {academic_year: "2023-24", reason_lab: "Violent (No Injury)", reason_rate: 0.02657},
                {academic_year: "2023-24", reason_lab: "Weapons", reason_rate: 0.00144},
                {academic_year: "2023-24", reason_lab: "Illicit Drugs", reason_rate: 0.00724},
                {academic_year: "2023-24", reason_lab: "Willful Defiance", reason_rate: 0.00245},
                {academic_year: "2023-24", reason_lab: "Other", reason_rate: 0.00158}
            ];
        }

        function generateGradeLevelData() {
            const levels = ['Elementary', 'Middle', 'High'];
            const years = ["2017-18", "2018-19", "2019-20", "2021-22", "2022-23", "2023-24"];
            const categories = Object.keys(categoryColors);
            const data = [];

            levels.forEach(level => {
                years.forEach((year, yearIndex) => {
                    const baseMultiplier = level === 'Elementary' ? 0.3 : level === 'Middle' ? 1.2 : 1.0;
                    const covidEffect = year === '2019-20' ? 0.6 : 1.0;
                    
                    categories.forEach(category => {
                        let baseRate;
                        switch(category) {
                            case 'Violent (No Injury)': baseRate = 0.025; break;
                            case 'Violent (Injury)': baseRate = 0.007; break;
                            case 'Willful Defiance': baseRate = 0.008 * (1 - yearIndex * 0.15); break;
                            case 'Illicit Drugs': baseRate = level === 'High' ? 0.012 : 0.003; break;
                            case 'Weapons': baseRate = 0.002; break;
                            default: baseRate = 0.002; break;
                        }
                        
                        data.push({
                            academic_year: year,
                            school_level: level,
                            reason_lab: category,
                            reason_rate: baseRate * baseMultiplier * covidEffect
                        });
                    });
                });
            });

            return data;
        }

        function generateLocaleData() {
            const locales = ['City', 'Suburban', 'Town', 'Rural'];
            const years = ["2017-18", "2018-19", "2019-20", "2021-22", "2022-23", "2023-24"];
            const categories = Object.keys(categoryColors);
            const data = [];

            locales.forEach(locale => {
                years.forEach((year, yearIndex) => {
                    const baseMultiplier = locale === 'City' ? 1.3 : locale === 'Rural' ? 0.8 : 1.0;
                    const covidEffect = year === '2019-20' ? 0.6 : 1.0;
                    
                    categories.forEach(category => {
                        let baseRate;
                        switch(category) {
                            case 'Violent (No Injury)': baseRate = 0.025; break;
                            case 'Violent (Injury)': baseRate = 0.007; break;
                            case 'Willful Defiance': baseRate = 0.008 * (1 - yearIndex * 0.15); break;
                            case 'Illicit Drugs': baseRate = locale === 'City' ? 0.010 : 0.006; break;
                            case 'Weapons': baseRate = 0.002; break;
                            default: baseRate = 0.002; break;
                        }
                        
                        data.push({
                            academic_year: year,
                            locale_simple: locale,
                            reason_lab: category,
                            reason_rate: baseRate * baseMultiplier * covidEffect
                        });
                    });
                });
            });

            return data;
        }

        function generateRaceData() {
            const races = ['Black', 'Hispanic', 'White', 'Asian', 'Pacific Islander', 'American Indian', 'Two or More'];
            const years = ["2017-18", "2018-19", "2019-20", "2021-22", "2022-23", "2023-24"];
            const categories = Object.keys(categoryColors);
            const data = [];

            // Racial disparity multipliers based on project findings
            const raceMultipliers = {
                'Black': 3.2,
                'American Indian': 2.8,
                'Pacific Islander': 1.8,
                'Hispanic': 1.2,
                'Two or More': 1.1,
                'White': 0.7,
                'Asian': 0.3
            };

            races.forEach(race => {
                years.forEach((year, yearIndex) => {
                    const raceMultiplier = raceMultipliers[race];
                    const covidEffect = year === '2019-20' ? 0.6 : 1.0;
                    
                    categories.forEach(category => {
                        let baseRate;
                        switch(category) {
                            case 'Violent (No Injury)': baseRate = 0.025; break;
                            case 'Violent (Injury)': baseRate = 0.007; break;
                            case 'Willful Defiance': 
                                baseRate = race === 'Black' ? 0.015 : 0.008; 
                                baseRate *= (1 - yearIndex * 0.15);
                                break;
                            case 'Illicit Drugs': baseRate = 0.006; break;
                            case 'Weapons': baseRate = 0.002; break;
                            default: baseRate = 0.002; break;
                        }
                        
                        data.push({
                            academic_year: year,
                            race_ethnicity: race,
                            reason_lab: category,
                            reason_rate: baseRate * raceMultiplier * covidEffect
                        });
                    });
                });
            });

            return data;
        }

        // Data object
        const suspensionData = {
            overall: generateOverallData(),
            grade: generateGradeLevelData(),
            locale: generateLocaleData(),
            race: generateRaceData()
        };

        // Initialize the dashboard
        function initDashboard() {
            setupEventListeners();
            updateVisualization();
        }

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('viewType').addEventListener('change', handleViewChange);
            document.getElementById('schoolLevel').addEventListener('change', updateVisualization);
            document.getElementById('schoolLocale').addEventListener('change', updateVisualization);
            document.getElementById('raceEthnicity').addEventListener('change', updateVisualization);
            document.getElementById('chartType').addEventListener('change', updateVisualization);
        }

        // Handle view type changes
        function handleViewChange() {
            const viewType = document.getElementById('viewType').value;
            
            // Show/hide relevant filters
            document.getElementById('gradeFilter').style.display = viewType === 'grade' ? 'block' : 'none';
            document.getElementById('localeFilter').style.display = viewType === 'locale' ? 'block' : 'none';
            document.getElementById('raceFilter').style.display = viewType === 'race' ? 'block' : 'none';
            
            updateVisualization();
        }

        // Update the visualization based on current selections
        function updateVisualization() {
            const viewType = document.getElementById('viewType').value;
            const chartType = document.getElementById('chartType').value;
            
            let filteredData, title, subtitle;
            
            switch(viewType) {
                case 'overall':
                    filteredData = suspensionData.overall;
                    title = 'Overall Suspension Category Trends';
                    subtitle = 'All students across all school types';
                    break;
                    
                case 'grade':
                    const selectedLevel = document.getElementById('schoolLevel').value;
                    filteredData = selectedLevel === 'all' ? 
                        suspensionData.grade : 
                        suspensionData.grade.filter(d => d.school_level === selectedLevel);
                    title = selectedLevel === 'all' ? 
                        'Suspension Trends by School Level' : 
                        `${selectedLevel} School Suspension Trends`;
                    subtitle = selectedLevel === 'all' ? 
                        'Comparing elementary, middle, and high schools' : 
                        `${selectedLevel} schools only`;
                    break;
                    
                case 'locale':
                    const selectedLocale = document.getElementById('schoolLocale').value;
                    filteredData = selectedLocale === 'all' ? 
                        suspensionData.locale : 
                        suspensionData.locale.filter(d => d.locale_simple === selectedLocale);
                    title = selectedLocale === 'all' ? 
                        'Suspension Trends by School Locale' : 
                        `${selectedLocale} Schools Suspension Trends`;
                    subtitle = selectedLocale === 'all' ? 
                        'Comparing city, suburban, town, and rural schools' : 
                        `${selectedLocale} schools only`;
                    break;

                case 'race':
                    const selectedRace = document.getElementById('raceEthnicity').value;
                    filteredData = selectedRace === 'all' ? 
                        suspensionData.race : 
                        suspensionData.race.filter(d => d.race_ethnicity === selectedRace);
                    title = selectedRace === 'all' ? 
                        'Suspension Trends by Race/Ethnicity' : 
                        `${selectedRace} Student Suspension Trends`;
                    subtitle = selectedRace === 'all' ? 
                        'Comparing racial/ethnic groups showing persistent disparities' : 
                        `${selectedRace} students only`;
                    break;
            }
            
            document.getElementById('chartTitle').textContent = title;
            document.getElementById('chartSubtitle').textContent = subtitle;
            
            createChart(filteredData, chartType, viewType);
            updateInsights(filteredData, viewType);
        }

        // Create the chart
        function createChart(data, chartType, viewType) {
            const ctx = document.getElementById('trendsChart').getContext('2d');
            
            if (currentChart) {
                currentChart.destroy();
            }

            const chartData = processDataForChart(data, viewType);
            
            const config = {
                type: chartType === 'area' ? 'line' : chartType,
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 15
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + (context.parsed.y * 100).toFixed(3) + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'Academic Year'
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'Suspension Rate (%)'
                            },
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return (value * 100).toFixed(1) + '%';
                                }
                            }
                        }
                    }
                }
            };

            if (chartType === 'area') {
                config.data.datasets.forEach(dataset => {
                    dataset.fill = true;
                    dataset.backgroundColor = dataset.borderColor + '40';
                });
            }

            currentChart = new Chart(ctx, config);
        }

        // Process data for chart display
        function processDataForChart(data, viewType) {
            const years = [...new Set(data.map(d => d.academic_year))].sort();
            const categories = [...new Set(data.map(d => d.reason_lab))];
            const datasets = [];

            if (viewType === 'overall') {
                categories.forEach(category => {
                    const categoryData = data.filter(d => d.reason_lab === category);
                    const values = years.map(year => {
                        const yearData = categoryData.find(d => d.academic_year === year);
                        return yearData ? yearData.reason_rate : null;
                    });
                    
                    datasets.push({
                        label: category,
                        data: values,
                        borderColor: categoryColors[category] || '#999',
                        backgroundColor: (categoryColors[category] || '#999') + '40',
                        borderWidth: 3,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        tension: 0.3
                    });
                });
            } else {
                let groupKey, groups;
                if (viewType === 'grade') {
                    groupKey = 'school_level';
                    groups = [...new Set(data.map(d => d.school_level))];
                } else if (viewType === 'locale') {
                    groupKey = 'locale_simple';
                    groups = [...new Set(data.map(d => d.locale_simple))];
                } else if (viewType === 'race') {
                    groupKey = 'race_ethnicity';
                    groups = [...new Set(data.map(d => d.race_ethnicity))];
                }
                
                if (groups.length === 1) {
                    categories.forEach(category => {
                        const categoryData = data.filter(d => d.reason_lab === category);
                        const values = years.map(year => {
                            const yearData = categoryData.find(d => d.academic_year === year);
                            return yearData ? yearData.reason_rate : null;
                        });
                        
                        datasets.push({
                            label: category,
                            data: values,
                            borderColor: categoryColors[category] || '#999',
                            backgroundColor: (categoryColors[category] || '#999') + '40',
                            borderWidth: 3,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            tension: 0.3
                        });
                    });
                } else {
                    const significantCategories = ['Violent (No Injury)', 'Willful Defiance', 'Violent (Injury)'];
                    significantCategories.forEach(category => {
                        groups.forEach((group, index) => {
                            const groupData = data.filter(d => 
                                d.reason_lab === category && d[groupKey] === group
                            );
                            const values = years.map(year => {
                                const yearData = groupData.find(d => d.academic_year === year);
                                return yearData ? yearData.reason_rate : null;
                            });
                            
                            const baseColor = categoryColors[category] || '#999';
                            
                            datasets.push({
                                label: `${category} - ${group}`,
                                data: values,
                                borderColor: baseColor,
                                backgroundColor: baseColor + '40',
                                borderWidth: 2,
                                pointRadius: 3,
                                pointHoverRadius: 5,
                                tension: 0.3,
                                borderDash: index > 0 ? [5, 5] : []
                            });
                        });
                    });
                }
            }

            return {
                labels: years,
                datasets: datasets
            };
        }

        // Update insights based on current data
        function updateInsights(data, viewType) {
            const insights = generateInsights(viewType);
            const container = document.getElementById('insightsContainer');
            
            container.innerHTML = insights.map(insight => `
                <div class="insight-item">
                    <h4>${insight.title}</h4>
                    <p>${insight.description}</p>
                </div>
            `).join('');
        }

        // Generate insights from data
        function generateInsights(viewType) {
            const insights = [];
            
            if (viewType === 'overall') {
                insights.push({
                    title: 'Willful Defiance Declining',
                    description: 'Willful Defiance suspensions have declined dramatically, from 1.6% of all suspensions in 2017-18 to just 0.5% in 2023-24, reflecting policy changes toward restorative justice practices.'
                });

                insights.push({
                    title: 'Violence Dominates Suspensions',
                    description: 'Violent incidents (with and without injury) account for over 70% of all suspensions, with "Violence without Injury" being the single largest category at about 55% of total suspensions.'
                });

                insights.push({
                    title: 'COVID-19 Impact',
                    description: 'All suspension categories show a notable decline in 2019-20 due to school closures, followed by increases in 2021-22 as schools reopened, particularly for violent incidents.'
                });

                insights.push({
                    title: 'Post-COVID Patterns',
                    description: 'Violent injuries have increased post-COVID, potentially reflecting heightened tensions and social-emotional challenges from the pandemic disruption to schooling.'
                });
            } else if (viewType === 'race') {
                insights.push({
                    title: 'Persistent Racial Disparities',
                    description: 'Black and American Indian students face suspension rates 3-4 times higher than White and Asian students across all categories, reflecting systemic inequities in school discipline practices.'
                });

                insights.push({
                    title: 'Disproportionate Willful Defiance',
                    description: 'While Willful Defiance suspensions have declined overall, Black students historically faced much higher rates in this subjective category, highlighting the importance of policy reforms.'
                });

                insights.push({
                    title: 'Violence Category Disparities',
                    description: 'Disparities in violent incident suspensions persist across racial groups, with Black students suspended at higher rates even for similar behaviors, suggesting potential bias in disciplinary decisions.'
                });

                insights.push({
                    title: 'Policy Reform Impact',
                    description: 'The decline in Willful Defiance suspensions has benefited all racial groups, but significant disparities remain in other categories, indicating need for continued reform efforts.'
                });
            } else {
                insights.push({
                    title: 'Differential Impacts by Context',
                    description: 'Suspension patterns vary significantly across school levels and locales, with high schools showing higher drug-related suspensions and urban schools showing different violence patterns than rural areas.'
                });

                insights.push({
                    title: 'Elementary School Patterns',
                    description: 'Elementary schools show much lower overall suspension rates but proportionally more "other" category suspensions, suggesting different disciplinary challenges for younger students.'
                });

                insights.push({
                    title: 'Geographic Disparities',
                    description: 'City schools typically show higher suspension rates across most categories, while rural schools have distinctive patterns for drug-related and weapons violations.'
                });

                insights.push({
                    title: 'Policy Implications',
                    description: 'The variation across contexts suggests that effective suspension reduction strategies need to be tailored to local school characteristics and student populations.'
                });
            }
            
            return insights;
        }

        // Initialize when page loads
        window.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>